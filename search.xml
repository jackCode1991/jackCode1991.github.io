<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ES看这一篇就够了</title>
      <link href="/2021/07/30/ES%E5%88%9D%E5%A7%8B/"/>
      <url>/2021/07/30/ES%E5%88%9D%E5%A7%8B/</url>
      
        <content type="html"><![CDATA[<h5 id="Elasticsearch插件安装"><a href="#Elasticsearch插件安装" class="headerlink" title="Elasticsearch插件安装"></a>Elasticsearch插件安装</h5><ol><li>下载插件</li><li>启动</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启动es服务 bin目录下的elasticsearch.bat文件，双击即可启动</span></span><br><span class="line"><span class="comment">#启动可视化界面</span></span><br><span class="line">npm install</span><br><span class="line">npm run start</span><br></pre></td></tr></table></figure><ol start="3"><li>链接测试发现，存在跨域问题，配置es</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http.cors.enabled: <span class="literal">true</span></span><br><span class="line">http.cors.allow-origin: <span class="string">&quot;*&quot;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>重启es</li></ol><p><img src="/assets/cover/elsticSearch-1.png" alt="image"></p><p>初学可以当作一个数据库！(可以建立索引(库))</p><blockquote><p>这个head我们就把它当作数据展示工具！查询在kibana</p></blockquote><p>1.安装kibana</p><p>2.汉化</p><p><img src="/assets/cover/elsticSearch-2.png" alt="image"></p><p>ik分词</p><p><img src="/assets/cover/elsticSearch-3.png" alt="image"></p><blockquote><p>安装</p></blockquote><p>1.下载插件</p><p>2.放入到elasticsearch插件即可</p><p><img src="/assets/cover/elsticSearch-4.png" alt="image"></p><p>3.重启观察ES，可以看到分词器被加载</p><p><img src="/assets/cover/elsticSearch-5.png" alt="image"></p><p>4.elasticsearch-plugin可以通过这个命令来查看加载进来的插件</p><p><img src="/assets/cover/elsticSearch-6.png" alt="image"></p><p>5.使用kibana测试！</p><blockquote><p>查看不同的分词效果</p></blockquote><p>其中ik_smart为最少切分</p><p><img src="/assets/cover/elsticSearch-7.png" alt="image"></p><p>ik_max_word最细力度切分</p><p><img src="/assets/cover/elsticSearch-8.png" alt="image"></p><blockquote><p>如何配置自己的字典</p></blockquote><p><img src="/assets/cover/elsticSearch-9.png" alt="image"></p><h5 id="Rest风格说明"><a href="#Rest风格说明" class="headerlink" title="Rest风格说明"></a>Rest风格说明</h5><p><img src="/assets/cover/elsticSearch-10.png" alt="image"></p><blockquote><p>基础测试</p></blockquote><p>1、创建一个索引</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PUT /索引名/~类型名~/文档id</span><br><span class="line">&#123;请求体&#125;</span><br></pre></td></tr></table></figure><p><img src="/assets/cover/elsticSearch-11.png" alt="image"></p><p>2、字段类型<img src="/assets/cover/elsticSearch-12.png" alt="image"></p><p>3.指定字段的类型</p><p><img src="/assets/cover/elsticSearch-13.png" alt="image"></p><p>4.获取具体的规则信息</p><p><img src="/assets/cover/elsticSearch-14.png" alt="image"></p><p>5.查看默认的类型</p><p><img src="/assets/cover/elsticSearch-15.png" alt="image"></p><p>如果自己的文档字段没有指定，那么es就会给我们默认指定！</p><p>扩展：通过命令elasticsearch索引情况！</p><p><img src="/assets/cover/elsticSearch-16.png" alt="image"></p><blockquote><p>修改索引</p></blockquote><p><img src="/assets/cover/elsticSearch-17.png" alt="image"></p><blockquote><p>删除</p></blockquote><p>通过deete命令实现删除、根据你的请求类判断删除索引还是删除文档</p><h5 id="关于文档的基本操作（重点）"><a href="#关于文档的基本操作（重点）" class="headerlink" title="关于文档的基本操作（重点）"></a>关于文档的基本操作（重点）</h5><blockquote><p>基本操作</p></blockquote><p>1.添加数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PUT /kuangshen/user/<span class="number">1</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>:<span class="string">&quot;狂神说&quot;</span>,</span><br><span class="line">  <span class="string">&quot;age&quot;</span>:<span class="number">3</span>,</span><br><span class="line">  <span class="string">&quot;desc&quot;</span>:<span class="string">&quot;一顿操作猛如虎，以看工资2500&quot;</span>,</span><br><span class="line">  <span class="string">&quot;tags&quot;</span>:[<span class="string">&quot;技术宅&quot;</span>,<span class="string">&quot;温暖&quot;</span>,<span class="string">&quot;直男&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/assets/cover/elsticSearch-18.png" alt="image"></p><p>2.获取数据</p><p><img src="/assets/cover/elsticSearch-19.png" alt="image"></p><p>3、更新数据 PUT（这样更新必须把所有字段列出，否则变空）</p><p><img src="/assets/cover/elsticSearch-20.png" alt="image"></p><p>4、Post    _update,推荐使用这种方式</p><p><img src="/assets/cover/elsticSearch-21.png" alt="image"></p><p><strong>简单搜索</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET kuangshen/user/1</span><br></pre></td></tr></table></figure><p>简单的条件查询</p><p><img src="/assets/cover/elsticSearch-22.png" alt="image"></p><blockquote><p>复杂操作 select(排序、分页、高亮、模糊查询)</p></blockquote><p><img src="/assets/cover/elsticSearch-23.png" alt="image"></p><p>输出结果，不想要那么多！</p><p><img src="/assets/cover/elsticSearch-24.png" alt="image"></p><blockquote><p>排序！</p></blockquote><p><img src="/assets/cover/elsticSearch-25.png" alt="image"></p><blockquote><p>分页</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">GET kuangshen/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;狂神&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;sort&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;age&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;order&quot;</span>: <span class="string">&quot;desc&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;from&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;size&quot;</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>布尔值查询</p></blockquote><p><img src="/assets/cover/elsticSearch-26.png" alt="image"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GET kuangshen/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;狂神&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>must （and）</p><p>should（or）</p><p>must_not (not)</p><blockquote><p>过滤查询</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">GET kuangshen/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;狂神&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">&quot;filter&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;range&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;age&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;gt&quot;</span>: <span class="number">10</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/assets/cover/elsticSearch-27.png" alt="image"></p><blockquote><p>匹配多个条件！</p></blockquote><p><img src="/assets/cover/elsticSearch-28.png" alt="image"></p><blockquote><p>精确查询</p></blockquote><p>term查询是直接通过倒排索引指定的词条进行精确的查找</p><p><strong>关于分词</strong>：text    keyword</p><ul><li><p>term，直接查询精确的</p></li><li><p>match，会使用分词器解析！</p></li></ul><p>两个类型</p><p><img src="/assets/cover/elsticSearch-29.png" alt="image"></p><p><img src="/assets/cover/elsticSearch-30.png" alt="image"></p><p><img src="/assets/cover/elsticSearch-31.png" alt="image"></p><blockquote><p>精确查询多个值</p></blockquote><p><img src="/assets/cover/elsticSearch-32.png" alt="image"></p><blockquote><p>高亮查询！</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET kuangshen/user/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;狂神说&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;highlight&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;pre_tags&quot;</span>: <span class="string">&quot;&lt;p class=&#x27;key&#x27; style=&#x27;color:red&#x27;&gt; &quot;</span>, </span><br><span class="line">    <span class="string">&quot;post_tags&quot;</span>: <span class="string">&quot;&lt;/p&gt;&quot;</span>, </span><br><span class="line">    <span class="string">&quot;fields&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span>:&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/assets/cover/elsticSearch-33.png" alt="image"></p><h5 id="集成springboot"><a href="#集成springboot" class="headerlink" title="集成springboot"></a>集成springboot</h5><blockquote><p>找官方文档</p></blockquote><p>1.找原生的文档</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.elasticsearch.client<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch-rest-high-level-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.找对象</p><p>3.分析类中的方法</p>]]></content>
      
      
      <categories>
          
          <category> 架构设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 组件 </tag>
            
            <tag> 分布式 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
